<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2016 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Routines to calculate source confusion</TITLE>
<META NAME="description" CONTENT="Routines to calculate source confusion">
<META NAME="keywords" CONTENT="ssclib">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2016">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ssclib.css">

<LINK REL="next" HREF="node46.html">
<LINK REL="previous" HREF="node41.html">
<LINK REL="up" HREF="ssclib.html">
<LINK REL="next" HREF="node46.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE"VLINK="#551A8B" ALINK="#FF0000"><A HREF=http://xmm.esac.esa.int/sas/><IMG SRC="../icons/xmmsaslogo.gif" ALT="XMM-Newton SAS Home Page" HEIGHT=60 WIDTH=60 ALIGN="LEFT"></A>
<DIV ALIGN=RIGHT><B><FONT SIZE=+2>XMM-Newton Science Analysis System</FONT>
<BR>
<BR>
<BR>
ssclib (ssclib-4.32) [xmmsas_20170112_1337-16.0.0]</B></DIV>
<BR CLEAR=ALL>

<DIV CLASS="navigation"><A HREF="node44.html"><IMG BORDER="0" SRC="../icons/prev.gif" ALT="Instrument spacecraft attitude"></A>
<A HREF="ssclib.html"><IMG BORDER="0" SRC="../icons/up.gif" ALT="Home Page"></A>
<A HREF="node46.html"><IMG BORDER="0" SRC="../icons/next.gif" ALT="A module which contains"></A>
<A HREF="index.html"><IMG BORDER="0" SRC="../icons/home.gif" ALT="Home"></A>

<A HREF="node195.html"><IMG BORDER="0" SRC="../icons/index.gif" ALT="Index"></A>
<BR><IMG BORDER="0" SRC="../icons/bar.gif">
<BR><A  HREF="../packages.html">Meta Index</A> / <A  HREF="ssclib.html">Home Page</A></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00040000000000000000"></A>
<A NAME="ssclib:description:confusion"></A>
<BR>
Routines to calculate source confusion
</H1>

<P>
Module name: <TT>confusion</TT>

<P>
Author: Ian Stewart (University of Leicester, ims@star.le.ac.uk)

<P>
<PRE>
  subroutine findConfusedSets(srcX, srcY, srcRadius, confSetNum)
    real(double),   intent(in)  :: srcX(:), srcY(size(srcX))
    real(double),   intent(in)  :: srcRadius(size(srcX))
    integer(int16), intent(out) :: confSetNum(size(srcX))
  end subroutine findConfusedSets

    This subroutine takes as inputs a list of source positions $srcX$ and $srcY$ and nominal radii $srcRadius$ and returns a list of indices $confSetNum$. An index of zero indicates that the source is not confused with any other in the set. Two sources are defined to be confused if the sum of their radii exceeds their separation distance. If the returned index for any source is greater than zero, that indicates that the source is confused with at least one other having the same index. The index values are set such that (i) any source having $confSetNum=i$ is confused with at least one other source having the same value of $confSetNum$, and (ii) no source with $confSetNum=i$ is confused with any source for which $confSetNum \ne i$. In diagrammatic form each confusion group would appear as an island of interlinked circles. Note however that it is \emph{not} necessarily true that, if sources $p$ and $q$ are members of the same confusion group, then $p$ is confused with $q$ - they could for example be at either end of a long chain of confused sources.

    There are no gaps in the returned sequence of confusion indices. Ie for all valid confusion indices $i&gt;1$, $i-1$ is also a valid confusion index.
</PRE>

<P>
<HR> <BR>
<ADDRESS>
XMM-Newton SOC/SSC -- 2017-01-12
</ADDRESS>
</BODY>
</HTML>
