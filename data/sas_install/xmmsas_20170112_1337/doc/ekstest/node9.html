<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2016 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Algorithm</TITLE>
<META NAME="description" CONTENT="Algorithm">
<META NAME="keywords" CONTENT="ekstest">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2016">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="ekstest.css">

<LINK REL="next" HREF="node10.html">
<LINK REL="previous" HREF="node8.html">
<LINK REL="up" HREF="ekstest.html">
<LINK REL="next" HREF="node10.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE"VLINK="#551A8B" ALINK="#FF0000"><A HREF=http://xmm.esac.esa.int/sas/><IMG SRC="../icons/xmmsaslogo.gif" ALT="XMM-Newton SAS Home Page" HEIGHT=60 WIDTH=60 ALIGN="LEFT"></A>
<DIV ALIGN=RIGHT><B><FONT SIZE=+2>XMM-Newton Science Analysis System</FONT>
<BR>
<BR>
<BR>
ekstest (ekstest-2.7) [xmmsas_20170112_1337-16.0.0]</B></DIV>
<BR CLEAR=ALL>

<DIV CLASS="navigation"><A HREF="node8.html"><IMG BORDER="0" SRC="../icons/prev.gif" ALT="Output Files"></A>
<A HREF="ekstest.html"><IMG BORDER="0" SRC="../icons/up.gif" ALT="Home Page"></A>
<A HREF="node10.html"><IMG BORDER="0" SRC="../icons/next.gif" ALT="Comments"></A>
<A HREF="index.html"><IMG BORDER="0" SRC="../icons/home.gif" ALT="Home"></A>

<A HREF="node12.html"><IMG BORDER="0" SRC="../icons/index.gif" ALT="Index"></A>
<BR><IMG BORDER="0" SRC="../icons/bar.gif">
<BR><A  HREF="../packages.html">Meta Index</A> / <A  HREF="ekstest.html">Home Page</A></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00080000000000000000"></A>
<A NAME="ekstest:description:algorithm"></A>
<BR>
Algorithm
</H1>

<P>
<PRE>
   Subroutine ekstest

     Recover parameters (File name, GTI file)
        
     Read source time series FITS file : 
        Get dataset(s) and table.
        Check important keyword consistency (notably TSTART and TIMEDEL).
        Call a warning or error if necessary.

     Recover all light curves included in table :
        Net source rates and errors and background rates and errors are recorded in arrays
        of dimension Nlightcurve * Nbins.

      For each light curve :

        Delete gaps in data (when the IEEE NaN constant is found) and outside of GTIs.

        Perform variability tests on rebinned counts and background or the net source counts and the cumulative time distribution:
           Calculate mean count rate and variance.
           Test the null hypothesis (the source is not variable) with the :
               - Kolmogorov-Smirnov test 
               - chi-squared test 
               - fractional variability amplitude test 
               - flare test
               - variation test 

     End for

     Write variability test results into header and/or to screen.
               
     Release memory.

   End subroutine ekstest
</PRE>

<P>
<HR> <BR>
<ADDRESS>
XMM-Newton SOC/SSC -- 2017-01-12
</ADDRESS>
</BODY>
</HTML>
