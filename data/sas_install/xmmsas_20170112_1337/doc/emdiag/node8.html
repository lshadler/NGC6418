<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2016 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Algorithm</TITLE>
<META NAME="description" CONTENT="Algorithm">
<META NAME="keywords" CONTENT="emdiag">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2016">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="emdiag.css">

<LINK REL="next" HREF="node9.html">
<LINK REL="previous" HREF="node7.html">
<LINK REL="up" HREF="emdiag.html">
<LINK REL="next" HREF="node9.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE"VLINK="#551A8B" ALINK="#FF0000"><A HREF=http://xmm.esac.esa.int/sas/><IMG SRC="../icons/xmmsaslogo.gif" ALT="XMM-Newton SAS Home Page" HEIGHT=60 WIDTH=60 ALIGN="LEFT"></A>
<DIV ALIGN=RIGHT><B><FONT SIZE=+2>XMM-Newton Science Analysis System</FONT>
<BR>
<BR>
<BR>
emdiag (emdiag-4.0.1) [xmmsas_20170112_1337-16.0.0]</B></DIV>
<BR CLEAR=ALL>

<DIV CLASS="navigation"><A HREF="node7.html"><IMG BORDER="0" SRC="../icons/prev.gif" ALT="Output Files"></A>
<A HREF="emdiag.html"><IMG BORDER="0" SRC="../icons/up.gif" ALT="Home Page"></A>
<A HREF="node9.html"><IMG BORDER="0" SRC="../icons/next.gif" ALT="Comments"></A>
<A HREF="index.html"><IMG BORDER="0" SRC="../icons/home.gif" ALT="Home"></A>

<A HREF="node12.html"><IMG BORDER="0" SRC="../icons/index.gif" ALT="Index"></A>
<BR><IMG BORDER="0" SRC="../icons/bar.gif">
<BR><A  HREF="../packages.html">Meta Index</A> / <A  HREF="emdiag.html">Home Page</A></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00080000000000000000"></A>
<A NAME="emdiag:description:algorithm"></A>
<BR>
Algorithm
</H1>

<P>
<PRE>
   subroutine emdiag

   Read the file names of input and output files

   Open files 
   Get keyword values   
 
   parameters read : choice of sub_tasks to execute
   Loop over input task parameters
      Read the task parameter / yes to perform the procedure,
                                no  not to perform it  /
   End loop

   Read CCD map

SUBROUTINE OFFSET 
   if offset requested  then
      mask out pixels with significant signal
      compute mean over rows and columns
      if selectfov then
         mask out pixels outside the field of view
         for all rows/columns with more than 4 pixels left
             recompute offset
      endif
      compute variance
   else
      read offsets from offset/variance file
   endif

SUBROUTINE EDUSOFT
   if edusoft requested  then
      simulate EDU action
      simulate EMDH thresholding
      mask out pixels belonging to valid events
   endif

SUBROUTINE THRESH
   if thresh requested  then
      subtract offsets
      identify pixels above EMDH lower threshold
      mask them out in map
   endif

   Write output files
   Close files

   end subroutine  emdiag
</PRE>

<P>
<HR> <BR>
<ADDRESS>
XMM-Newton SOC/SSC -- 2017-01-12
</ADDRESS>
</BODY>
</HTML>
