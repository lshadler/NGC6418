<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2016 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>Algorithm</TITLE>
<META NAME="description" CONTENT="Algorithm">
<META NAME="keywords" CONTENT="efftplot">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META NAME="Generator" CONTENT="LaTeX2HTML v2016">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="efftplot.css">

<LINK REL="next" HREF="node10.html">
<LINK REL="previous" HREF="node8.html">
<LINK REL="up" HREF="efftplot.html">
<LINK REL="next" HREF="node10.html">
</HEAD>

<BODY TEXT="#000000" BGCOLOR="#FFFFFF" LINK="#0000EE"VLINK="#551A8B" ALINK="#FF0000"><A HREF=http://xmm.esac.esa.int/sas/><IMG SRC="../icons/xmmsaslogo.gif" ALT="XMM-Newton SAS Home Page" HEIGHT=60 WIDTH=60 ALIGN="LEFT"></A>
<DIV ALIGN=RIGHT><B><FONT SIZE=+2>XMM-Newton Science Analysis System</FONT>
<BR>
<BR>
<BR>
efftplot (efftplot-2.20) [xmmsas_20170112_1337-16.0.0]</B></DIV>
<BR CLEAR=ALL>

<DIV CLASS="navigation"><A HREF="node8.html"><IMG BORDER="0" SRC="../icons/prev.gif" ALT="Output Files"></A>
<A HREF="efftplot.html"><IMG BORDER="0" SRC="../icons/up.gif" ALT="Home Page"></A>
<A HREF="node10.html"><IMG BORDER="0" SRC="../icons/next.gif" ALT="Comments"></A>
<A HREF="index.html"><IMG BORDER="0" SRC="../icons/home.gif" ALT="Home"></A>

<A HREF="node14.html"><IMG BORDER="0" SRC="../icons/index.gif" ALT="Index"></A>
<BR><IMG BORDER="0" SRC="../icons/bar.gif">
<BR><A  HREF="../packages.html">Meta Index</A> / <A  HREF="efftplot.html">Home Page</A></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION00080000000000000000"></A>
<A NAME="efftplot:description:algorithm"></A>
<BR>
Algorithm
</H1>

<P>
<PRE>
   Subroutine efftplot

     Recover the parameters

     Read source time series FITS file : 
        Get dataset and table.
        Get the number of RATE columns (NCOLUMNS)
        Get the number of bins in the lightcurve (NBINLC)

     Check if the device type and output file parameters are valid

     If not, then
         Set the device type and the output file to the default values
         Check if the default values are valid
         If not, raise an error and exit

     Open device

     For each RATE column :

        Create a command line for POWSPEC
        Run POWSPEC with the following options (the relevant ones are given):
               - Nbint is the closest power of 2 lower than the number 
                 of bins of the input light curve (computed from Nbins)
               - rebin=0 (rebin=no)
               - itre=0 (removetrend=no)
               - gapfill=0 (fillgaps=no)
               - normalization=1 
               - Nbintfm = NBINLC/Nbint (i.e the last incomplete
                 data segment is ignored).

        Read the PDS so produced
        Draw the PDS with the help of the PGPLOT library     

     Endfor

     Close device
     Release memory.
     delete POWSPEC temporary files     

   End subroutine  efftplot
</PRE>

<P>
<HR> <BR>
<ADDRESS>
XMM-Newton SOC/SSC -- 2017-01-12
</ADDRESS>
</BODY>
</HTML>
