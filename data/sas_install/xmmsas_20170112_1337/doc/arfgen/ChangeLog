ChangeLog for arfgen
=================

Version 1.93.1 - 2016-12-01 (RDS)
------------
	+ (src/BadPixelCorrector.cc,      - Ensure that the OFFSETn.ds
	       BadPixPSFCorrector.cc,       temporary files are deleted
	       DetmapFilter.cc)             at the end of the run
	                                        (SPR-7412)

Version 1.93 - 2016-04-20 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc)  - Support boxes and RAW-Y range
	   src/RegionFunctions.cc)	    when extracting FAST mode data
	   					(SPR-7342)

Version 1.92 - 2015-12-04 (RDS)
------------
	+ (src/BadPixelCorrector.cc)      - Uses the NEXT_TO_OFFSET_COLUMN
					    rather than CLOSE_TO_BAD_COLUMN
					    to interpret pixels lying next to
					    offset columns.  (SPR-7330)

Version 1.91 - 2015-09-01 (RDS)
------------
	+ (src/PositionUtils.cc)          - Use observation time when 
					    accessing the boresight matrix
					    (SCR-7265)

Version 1.90.4 - 2014-10-14 (RDS)
------------
	+ (doc/arfgen_description.tex)    - Addition on XMMEA_EM (SPR-7224)

Version 1.90.3 - 2014-09-23 (RDS)
------------
	+ (src/PositionUtils.cc)          - Support conversion of fractional
					    raw pixels to detector coordinates.
					    This allows spectra extracted from 
					    timing mode annuli to be 
					    used directly (SPR-3048)

Version 1.90.2 - 2014-09-16 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc)  - Change the parameter name from
					    applymirroradjustment to
					    applyxcaladjustment

Version 1.90.1 - 2014-09-10 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc)  - Automatically set the number of 
	   config/arfgen.par/lyt,	    detector map bins to use
	   doc/arfgen_description.tex)             (SPR-7219)

Version 1.90 - 2014-04-25 (RDS)
------------
	+ (src/DatafileAttributes.cc)     - Set the observation data in the
					    calServer while getting the
					    datafile attributes.
						(SCR-7196)

Version 1.89 - 2014-04-21 (AI)
------------
	+ gcc4.8.2 portability changes

Version 1.88 - 2014-04-03 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc,
	   src/CalCoreData.cc/h,
	   config/arfgen.par) 

	 Addition of new parameter "applymirroradjustment" which 
	 controls use of an adjustment array for the mirror effective areas
	 (SCR-7192)

	+ (src/OffCCDPixelIterator.cc/h)

	 Fixed bug which caused one of the columns next to a chip gap 
	 NOT to be excluded from the area calculation even when it has
	 been excluded by the event flagging. 
	 (SPR-7198)
	

Version 1.87 - 2014-03-17 (RDS)
------------
	+ (src/CalPsfModel.cc)           - Further fix for SPR-7186

Version 1.86 - 2014-01-15 (RDS)
------------
	+ (doc/arfgen_description.tex)   - Fixed error in cross-arf description
	+ (src/ConcreteArfDataServer.cc) - Fixed error in the width of grid
					   pixels used to calculate the PSF 
					   and also the bad pixels
					      (SPR-7186)

Version 1.85.2 - 2013-11-13 (RDS)
------------
        + (src/ConcreteArfDataServer.cc) - Change vector to uint32_t in
					   dsslib bit mask call

Version 1.85.1 - 2013-11-06 (RDS)
------------
	+ (test/testarfgen_mos)            - Removal of reference to a 
					     temporary CIF
 
Version 1.85 - 2013-07-23 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc/h  - Introduction of a contamination 
	   src/CalCoreData.cc/h              model for the MOS cameras.
	   src/AreaCalc.cc/h) 		         (SCR-7106)					   

Version 1.83.4 - 2012-06-18 (RDS)
------------
	+ Copy of 1.84

Version 1.84 - 2012-06-07 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc) - Fixed problem with the PSF 
					   calculation for the FAST modes
					   where a subset of the full-Y
					   range is taken. (SPR-6733)

Version 1.83.3 - 2012-05-17 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc, - Put some logic into the calculation
	   config/arfgen.par)		   of the default badpixresolution to
				   	   make it fine (0.5") if a PSF corr is
					   being calculated and coarse (2") if
					   it isn't. (SPR-6729)

Version 1.83.2 - 2012-05-11 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc) - Recentreing of the PSF calculation
					   For Timing and Burst modes
						(SPR-6722)

Version 1.83.1 - 2012-04-25 (RDS)
------------
	+ (src/RatioPsfModel.cc)         - Fixed bug with very large source
					   box areas overflowing variable
						(SPR-6699)

Version 1.83 - 2012-03-27 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc, - Change over to use the ELLBETA
	   src/CalCoreData.cc/h,           PSF model by default for EE 
	   src/CalPsfModel.cc/h)           correction and bad pixel estimation.
					   EXTENDED mode is still supported 
					   but other modes are now deprecated
					   (SPR-6696)

Version 1.82 - 2012-03-22 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc, - Uses the SRCPOS value in the 
	   src/CalCoreData.cc/h,           spectrum header to calculate the 
	   src/CalPsfModel.cc/h)           PSF correction and the
					   pattern fractions for PN timing
					   mode (SPR-6582)

Version 1.81 - 2011-01-07 (RDS)
------------
	+ (src/PosWCS.cc)                - Changed WCSConverter call
	   src/CalPsfModel.cc,	 	   to give crpix values as signed
	   src/BadPixelCorrector.cc	   integers (SPR-6685) + removed
					   debug

Version 1.80.2 - 2011-09-28 (RDS)
------------
	+ (src/BadPixelCorrector.cc/h)   - Changed to exclude CCDs from the
	   src/ConcreteArfDataServer.cc)   bad pixel calculation when a CCD 
					   expression is part of the
					   extraction region (SPR-6671)

Version 1.80.1 - 2011-01-07 (RDS)
------------
	+ (src/RegionExtent.cc)          - Changed logic to give the
					   extents as the greater of the
					   POS or DET zones.
						(SPR-6642)

Version 1.80   - 2010-11-16 (RDS)
------------
	+ Added parameter psfmodel which allows
	  the user to choose the psf model (SPR-6625).
	+ Improved docuemtnation for chip gaps

Version 1.79   - 2010-10-26 (RDS)
------------
	+ Removed debug
 
Version 1.78   - 2010-09-17 (RDS)
------------
	+ (src/OffCCDPixelIterator.cc/h) - Solved problem with inaccurate
					   bad pixel calculation. Now uses
					   subpixels. It is slower
					   now for large areas. (SPR-6630)

Version 1.77.2   - 2010-04-19 (RDS)
------------
	+ (src/CalPsfModel.cc)           - removed reference to psf->atOrigin
					   which was causing problem with
					   bad pixel contribution
						(SPR-6607)

Version 1.77.1   - 2010-04-14 (RDS)
------------
	+ (src/PointEeCorrector.cc)      - Fully restored references to ELLBETA
						(SPR-6607)

Version 1.77   - 2010-03-22 (RDS)
------------
	+ (src/CalCoreData.cc,
	  (src/CalPsfModel.cc,
	   src/ConcreteArfDataServer.cc) - Restored references to ELLBETA

Version 1.76.6   - 2009-09-03 (AI)
------------
	+ Fixes to make arfgen gcc4-3 compliant

Version 1.76.5   - 2009-07-10 (AI)
------------
	+ (src/CalPsfModel.cc) Psf::BinSize renamed to Psf::ValidBinSize.
	This change is part of the gcc4 porting (see: cal/src/PsfDataServer.h)
	
Version 1.76.4   - 2009-06-15 (AI)
------------
	+ Debug line removed
	
Version 1.76.3   - 2009-06-12 (RDS)
------------
	+ (src/CalCoreData.cc,
	  (src/CalPsfModel.cc,
	   src/ConcreteArfDataServer.cc)) - Removed references to ELLBETA

Version 1.76.2   - 2009-05-13 (RDS)
------------
	+ (src/CalCoreData.cc)            - Solved a problem with the PSF calculation
					    in Timing mode. It now uses the PSF
					    image to calculate the enclosed energy
					    within the source box

Version 1.76.1   - 2008-10-24 (RDS)
------------
	Copy of 1.76

Version 1.75.6   - 2008-10-20 (RDS)
------------
	Copy of 1.76

Version 1.76   - 2008-09-09 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc)  - Added 0.5 pixels onto the width 
					    of the RAWX timing expression 
					    which was being calculated
					    too small (SPR-6500)

Version 1.75.5   - 2008-06-20 (RDS)
------------
	+ (src/CalPsfModel.cc)	          - Avoid problem with NAN in
					    calculation of elliptical PSF
						(SPR-6484)

Version 1.75.4   - 2008-06-19 (RDS)
------------
	+ (src/CalPsfModel.cc)	          - Fixed problem with bad-pixel
					    calculation with elliptical PSF
						(SPR-6484)

Version 1.75.2   - 2008-06-06 (RDS)
------------
	+ (src/CalPsfModel.cc/h)	  - Speeded up the cross-ARF calculation   
Version 1.75.1   - 2008-05-22 (RDS)
------------
	+ (src/PointEeCorrector.cc        - Set ELLBETA PSF iterator to 1 pixel
	   src/CalCoreData.cc)              Take maximum ellipical radius.
						(SPR-6465)
	+  test/testarfgen_mos_flatdetmap   Speeded up test

Version 1.75   - 2008-04-30 (RDS)
------------
	+ (src/CalCoreData.cc/h           - Added support for the ELLBETA
	   src/CalPsfModel.cc/h)	    PSF model. It is only used if
					    the source region is an 'optimum'
					    ellipse.

Version 1.74.3 - 2008-04-24 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc)  - uses 2-arcsec resolution in the
					    2-d map to speed-up execution time.

Version 1.74.2 - 2007-10-11 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc)  - now uses a 2-d map to handle
					    the backscale calculation rather
					    than the spans.

					  - Also handles AXES called AXIS2D3

Version 1.74.1 - 2007-08-31 (RDS)
------------
        + (src/RegionFunctions.cc)     - Fixed a problem with rotated ellipses
										 which were effectively treated as
										 unrotated before in the BACKSCAL
										 calculation (SPR-2725)

Version 1.74 - 2007-08-17 (RDS)
------------
        + (config/arfgen.par)          - Use logic to set booleans automatically
										 when a referred parameter is set.
										 Affects: withdetbounds, withfilteredset, 
												  withsourcepos, withrmfset
											(SPR-2702)

Version 1.73.2 - 2007-08-09 (RDS)
------------
        + (src/RatioPsfModel.cc/h,     - In the case of a selection containing
		   src/AreaCalc.cc,				 a mask the code now uses the
		   ConcreteArfDataServer.cc/h,   detector map to calculate the 
		   test/testarfgen_mos_mask )    source box size. This solves problems
										 with the BACKSCAL and chip gap
										 calculation in this case (SPR-2723)

Version 1.73.1 - 2007-06-15 (RDS)
------------
        + (src/RegionFunctions.cc)     - Now handles the backscale calculation
										 for non-contiguous areas in Timing
										 or BURST mode obs (SPR-2595)

Version 1.73 - 2007-04-24 (RDS)
------------
        + (src/BadPixelCorrector.cc)    - Changed from excluding 3x3
										  pixels around a bad pixel to 
										  the "cross" of 5 pixels that 
										  it should be (SPR-2707).

Version 1.72 - 2007-04-17 (RDS)
------------
        + (src/RegionFunctions.cc)      - Fixed a problem with RECTANGLES
										  not converting properly between 
										  RAW and DET coords.

Version 1.71 - 2006-09-05 (RDS)
------------
        + (src/ConcreteArfDataServer.cc/h,
               CrossRegionArf.cc/h,
               AreaCalc.cc/h)           - Added the capability to produce
                                          an ARF relevant to flux which spills
                                          over from one region into another
                                          (SPR-2690)

Version 1.70.4 - 2006-06-20 (RDS)
------------
        + (src/ConcreteArfDataServer.cc,
               RegionFunctions.cc)     - Fixes a problem where the bad
										 pixel and offset column
										 corrections were miscalculated for
										 MOS Timing mode, causing -ve
										 BACKSCAL values (SPR-2684)

Version 1.70.3 - 2006-06-07 (RDS)
------------
        + (src/CalPsfModel.cc/h,
           ConcreteArfDataServer.cc,   - Calculates burst mode psf and
           CalCoreData.cc/h,             applies a ratio correction in the
           RatioEeCorrector.cc/h,        case of an incomplete selection
           RatioPsfModel.cc)             in RAW-Y

Version 1.70.2 - 2006-06-06 (RDS)
------------
        + (doc/arfgen_desc.tex)        - Explained the difference in vignetting
                                         between point and extended sources
                                         (SPR-2519)

Version 1.70.1 - 2006-03-17 (RDS)
------------
        Copy of 1.70 for CVS.

Version 1.70 - 2006-02-21 (RDS)
------------
        + (src/CalPsfModel.cc)         - Better treatment of encircled energy 
                                         correction in rectangle or box
                                         extraction regions. Enables the
                                         PSF to be handled for Timing/Burst 
                                         mode observations (SPR-2612)

Version 1.69.1 - 2006-01-16 (RDS)
------------
        + (src/Setbackscale.cc)        - Set backscale to zero if calculated
                                         to be negative

Version 1.69 - 2005-12-21 (RDS)
------------
        + (src/OffCCDPixelIterator.cc, - event flag handling now deals with
           BadPixelCorrector.cc,       bit flags individually. This is
           ConcreteArfDataServer.cc)   primarily intended for the new #XMMEA_SM
                                       flag that includes events next to dead 
                                       pixels but excludes everything else
                                       (SCR-198).

Version 1.68.2 - 2005-12-07 (RDS)
------------
        + (src/ConcreteArfDataServer.cc) If the PPSVERS string is not set
                                         to a date then a suitable default 
                                         is selected (SPR-2644)

Version 1.68.1 - 2005-12-04 (RDS)
------------
        + (src/OffCCDPixelIterator.cc) Corrected an error introduced in V1.68
                                      where the windowing wasn't handled 
                                      properly outside the central chip
                                      (SPR-2642)

Version 1.68 - 2005-10-07 (RDS)
------------
        + (src/OffCCDPixelIterator.cc) Checks all chips for out of CCD window
                                       to cover the PN Large window case
                                       which affects all CCDs (SPR-2531)

Version 1.66.4 - 2005-08-05 (RDS)
------------
        + Documentation update

Version 1.66.3 - 2005-08-04 (RDS)
------------
        + Copy of 1.67 for thre release track.

Version 1.67 - 2005-08-01 (RDS)
------------
        + (src/CalCoreData.cc)        Fixes bug where an include and exclude
                                      circle are treated as an annulus even when
                                      their centres are distant (SPR-2624)

Version 1.66.2 - 2005-07-04 (RDS)
------------
        + (src/DetmapFilter.cc)       Uses an object for attcalc parameters
                                      to avoid having to close down and reopen
                                      parameters from calling task

        + (src/OffCCDPixelIterator.cc/h, Includes or excludes area
           ConcreteArfDataServer.cc,     out of the FOV depending on
           config/arfgen.par/lyt)        command line parameter ignoreoutoffov
                                         (SPR-2622)

Version 1.66.1 - 2005-06-28 (RDS)
------------
        + (src/DatafileAttributes.cc) Sets the instrument before the
                                      window mode to avoid warning message.

Version 1.66 - 2005-06-15 (RDS)
------------
        + (src/BadPixelCorrector.cc)  Correctly interprets FLAG=0 value for
                                      bad pixels (SPR-2609)

        A side benefit of this change is that pixels which are included
        in bad pixel AND bad column extensions are now only counted once
        in the effective area generation, whereas before they were included
        twice.

Version 1.65.18 - 2005-02-25 (RDS)
------------
        + (src/DatafileAttributes.cc) Interprets mode properly for outer
                                      CCDs odf timing mode MOS obs (SPR-2601)

Version 1.65.17 - 2004-12-21 (RDS)
------------
        + (DEPEND)                    Added selectlib dependancy (SPR-2569)

Version 1.65.16 - 2004-08-13 (RDS)
------------
        + (config/arfgen.par)         Changed photon energy to 2 keV (SPR-2528)
                                      Also changes useodfatt default from 
                                      true to false (SPR-2544) 
          (src/ConcreteArfDataServer.cc,
           src/CheckExpr.cc/h)        Added code to handle a sky or DETX/Y mask.
                                      NB: ARF generation is supported but the
                                      BACKSCAL value will be wrong for
                                      masked regions (SPR-2090)

Version 1.65.15 - 2004-07-21 (RDS)
------------
        + (src/ConcreteArfDataServer.cc,  Corrects for the ratio of Burst
           src/RatioEeCorrector.cc/h      mode data in extraction window
                                          (SPR-2541)

Version 1.65.14 - 2004-06-15 (RDS)
------------
        + (src/OffCCDPixelIterator.cc)  Ignores pixels outside the FOV.
                                        (SSC-SPR-3338)

Version 1.65.13 - 2004-05-26 (RDS)
------------
        + (src/Detmapfilter.cc)    Fixes problem with axes of type 
                                   AXIS2D1 (SPR-2532)

Version 1.65.12 - 2004-03-17 (RDS)
------------
        + (src/DatafileAttributes.cc)  Attempts to read frame time from 
                                       CCD 2 exposure map to cope with
                                       imaging data from Timing mode obs.

Version 1.65.11 - 2004-03-16 (RDS)
------------
        + (src/ConcreteArfDataServer.cc)  Fixed problem with CCD selection
                                          (SPR-2513)

Version 1.65.10 - 2004-03-08 (RDS)
------------
        + (src/ConcreteArfDataServer.cc)  A dummy spatial area is now only
                                          generated for Timing mode spectra
                                          when the RAW-X and RAW-Y axes are
                                          not selected, otherwise it cause
                                          a problem in backscale.

Version 1.65.9 - 2004-02-23 (RDS)
------------
        + (src/ConcreteArfDataServer.cc)  Specifically set source region
                                          centred on boresight for
                                          Timing/Burst mode obs whether
                                          user has selected an area or not.
        + (doc/arfgen_description.tex)    Explain Timing mode treatment

Version 1.65.8 - 2004-02-11 (RDS)
------------
        + (src/PositionUtils.cc/h)      - removes failure when source box
                                          includes area outside observing
                                          window.

Version 1.65.7 - 2004-02-10 (RDS)
------------
        + (src/OffCCDPixelIterator.cc)  - Only sets Cal CCD state if non zero
                                          to avoid unnecessary warnings.
        + (src/DatafileAttributes.cc/h) - Fixed problem with SUBMODE='Unknown'
                                          for MOS Timing mode data outer CCDs.

Version 1.65.6 - 2004-02-09 (RDS)
------------
        +                            - remove extraneous large file

Version 1.65.5 - 2004-02-04 (RDS)
------------
        + (src/BadPixelCorrector.cc/h) - Forceably remove temporary bad
                                         column file (SCR-SPR-3247)

Version 1.65.4 - 2004-01-21 (RDS)
------------
        + (src/CalCoreData.cc/h)     - new method checkModePattern which
                                       issues a warning if PN Timing mode
                                       data used without patterns 0-4 (SCR-150)

Version 1.65.3 - 2004-01-19 (RDS)
------------
        + (src/PosWCS.cc,h)          - fixed problem with X/Y to DET
                                       coord conversion when sky grid not
                                       centred on optical-axis (SPR-2497)

Version 1.65.2 - 2003-12-19 (RDS)
------------
        + (src/ConcreteArfDataServe.cc) - Fixed problem with filtering
                                          detector map (SPR-2310)
                                          Coarser gridding for large
                                          area calculation (SPR-2274)

Version 1.65.1 - 2003-12-17 (RDS)
------------
        + (src/BadPixelCorrector.cc) - added support for MOS offset columns
                                       (SCR-127)

Version 1.65 - 2003-11-12 (RDS)
------------
        + (src/ConcreteArfDataServer.cc) - fixed bug in readDss which
                                           caused static build runtime problem.

Version 1.64 - 2003-11-11 (RDS)
------------
        + (test/verifyarf)             - remove temp file to avoid
                                         run-time problem (SPR-2475)

Version 1.63 - 2003-11-05 (RDS)
------------
        + (test/Makefile)              - removes files such as core.* 
                                       - during clobber
        + (src/OffCCDPixelIterator.cc) - sets bad if outside observing
                                       - window or FOV (SPR-2450)

Version 1.62 - 2003-11-05 (RDS)
------------
        + (src/OffCCDPixelIterator.cc,  - checks whether pixels lie
               OffCCDPSFCorrector.cc)    - on selected CCDS, and sets them
                                         - bad if not (SPR-2450)

Version 1.61 - 2003-09-16 (RDS)         
------------
        + (src/ConcreteDataServer.cc)  - issues warning if DET and POS
                                         regions defined (SPR-2464)
        + (src/BadPixelCorrector.cc,   - fixed problem when OFFSETS table
          src/BadPixPSFCorrector.cc)     contains 0 records (SPR-2469)
                                         and with OFFSET column calculation
                                         in general (SPR-2470)

Version 1.60 - 2003-09-03 (RDS)
------------
        No change, upload with different number

Version 1.59 - 2003-08-13 (RDS)
------------
        + (src/PositionUtils.cc)     - fixed error in ODF attitude calc.
                                       (SPR-2463)

Version 1.58 - 2003-07-15 (RDS)
------------
        + (src/BadPixelCorrector.cc)     - fixed problem with bad columns
        + (test/testarfgen_pn)           - added new test for bad pixels

Version 1.57 - 2003-07-09 (RDS)
------------
        + (src/RegionFunctions.cc,
           src/ConcreteArfDataServer.cc) - Change for new dsslib API

Version 1.54.10 - 2003-07-03 (RDS)
------------
        + (src/ConcreteArfDataServer.cc) - Added code to convert RAW - DET
        + (src/RegionFunctions.cc/h)       coords for Timing mode (SPR-2452)
        + (src/PositionUtils.cc/h)       - Fixed problem with coordinate
                                           conversions (SPR-2463)

Version 1.54.9 - 2003-04-24 (RDS)
------------
        + (src/BadPixelCorrector.cc/h - handles bad columns (SPR-2367)
        + (test/pnspectrum.ds) - incorrect SUBMODE keyword corrected
        + (src/DatafileAttributes.cc/h) - Restructuring to allow keywords
        + (src/ConcreteArfDataServer.cc) - to be read in one place

Version 1.54.8 - 2003-03-13 (RDS)
------------
        + (src/ConcreteArfDataServer.cc) - allowed polygons (SPR-2401)

Version 1.54.7 - 2003-01-09 (RDS)
------------
        + (src/Detmapfilter.cc) - added DATE-END keyword into rawpixellist.
                                  This is now needed by attcalc.

Version 1.54.6 - 2002-12-18 (RDS)
------------
        + documentation update

Version 1.54.5 - 2002-12-05 (RDS)
------------
        + (config/arfgen.par) - changed default eegridfactor to 50 (SPR-2374)

Version 1.54.4 - 2002-12-02 (RDS)
------------
        + (src/IterEeCorector.cc) - fixed bug with PSF energy interpolation
                                    (SPR-2374)

Version 1.54.3 - 2002-11-25 (RDS)
------------
        + (src/ConcreteArfDataServer.cc) - fixed flag problem (SPR-2372)
                                         - Make the timing mode dummy region
                                           near to the boresight

Version 1.54.2 - 2002-11-12 (RDS)
------------
        + (src/OffCCDPixelIterator.cc,
           src/ConcreteArfDataServer.cc/h) - include support for flags

Version 1.54.1 - 2002-11-05 (RDS)
------------
        + (src/CalCoreData.cc,
           src/CalPsfModel.cc) Support for a quick calculation of the PSF
                               for a box region (for Timing mode) (SPR-2348)

Version 1.54 - 2002-10-30 (RDS)
------------
        Basically a rename of 1.48.11 with a little tidying.

Version 1.48.11 - 2002-09-30 (RDS)
------------
        This is indentical to 1.53 except that it is intended for the
        release track and hence uses the old parameter interface (RDS)

Version 1.53 - 2002-09-19 (RDS)
------------
	+ (src/ConcreteArfDataServer.cc) Added support for timing and burst mode                            - create a false DETX/Y dss region  (SPR-2348)
        + (src/PositionUtils.cc) Added support for source position in
                                 TELescope coords (type="TEL")  (SPR-2347)
        + (src/CalCoreData.cc) Made bad pattern treatment consistent (SPR-2346)
        + (doc/arfgen_description.tex) Explained pattern selection (SPR-2330)

Version 1.52 - 2002-09-13 (RDS)
------------
	+ (src/CalCoreData.cc) Fixed pattern bounds problem (SPR-2340)
	+ (src/Arfgen.cc) Added HDUVERS keywords (SPR-2336)

Version 1.51 - 2002-08-19 (UL)
------------
	+ a few transparent changes to improve C++ standard compliance

Version 1.50   - 2002-08-07 (RDS)
------------------------------
+ (DEPEND)               Added sas package dependency

Version 1.49   - 2002-05-16 (RDS)
------------------------------
+ (config/arfgen.par)    Converted to new parameter system

Version 1.48.9 - 2002-04-22 (RDS)
------------------------------
+ (src/CalCoreData.cc) - remove the error message in the destructor (SPR-2296)

Version 1.48.8 - 2002-04-11 (RDS)
------------------------------
More documentation.

Version 1.48.7 - 2002-03-19 (RDS)
------------------------------
Just documentation.

Version 1.48.6 - 2002-03-8 (RDS)
------------------------------
+ (src/DetmapFilter.cc) - reset the CAL accuracy mode after attcalc

Version 1.48.5 - 2002-02-20 (RDS)
------------------------------
+ (src/ConcreteArfDataServer.cc) Set the window mode in the Cal server
  (src/CalCoreData.cc)           Set number of patterns correctly for PN

Version 1.48.4 - 2002-02-19 (RDS)
------------------------------
+ (src/Areacalc.cc) (SPR-2142 - Q.E. applied spatially)
  (src/CalCoreData.cc/h etc..) (SPR-2047 - removed asserts)

Version 1.48.3 - 2002-02-07 (RDS)
------------------------------
Remove dependency on rmfgen from DEPENDS.

Version 1.48.2 - 2002-02-04 (RDS)
------------------------------
+ (src/ConcreteArfDataServer.cc) (SPR-2144, 2162 - more shapes + box width
                                                   errors )
  (src/ConcreteArfDataServer.cc) Removed the need to add a ':' for the
                                 datamaptype=dataset, dataset definition

Version 1.48.1 - 2002-01-25 (RDS)
------------------------------
+ (src/ConcreteArfDataServer.cc/h, src/OffCCDPixelIterator.cc/h,
   src/OffCCDPSFCorrector.cc) treatment of edge pixels (SPR-2117)
  (src/CalCoreData.cc/h)      (SCR-72 - pattern fractions)

Version 1.48 - 2002-01-23 (RDS)
------------------------------
+ (ConcreteArfDataServer.h, RegionExtent.h/cc,
CalCoreData.h, CoreData.h) - dsslib made non-const (SPR-2162)

Version 1.47 - 2001-12-10 (RDS)
------------------------------
+ (config/arfgen.par,                    
   src/ConcreteArfDataServer.cc,                 
   src/CalCoreData.cc/h,CoreData.h) removed the params withpatterns, 
                                    patternmin, patternmax (SPR-2069)

Version 1.46.1 - 2001-12-05 (RDS)
------------------------------
+ (src/CalCoreData.cc, src/CalPsfModel.cc/h, src/RatioPsfModel.h/cc,
   src/PointEeCorrector.cc, src/PsfModel.h, Makefile) 
                     - new encircled energy CAL implementation (SPR-2233)
- (src/CirclePsfModel.cc/h, DummyPsfModel.cc/h) - removed.

+ (src/ConcreteArfDataServer.cc/h, AreaCalc.cc/h,
   arfgen.par - new param modelootcorr ) - OOT correction (SCR-14, SPR-2198)

Version 1.46 - 2001-10-31 (UL)
------------------------------
+ brought in line with cal-3.121: type of CAMCOORD/TELCOORD coordinates
  changed from single to double precision

Version 1.45  2001-08-06 (RDS)
------------------------------
+   (doc/arfgen_description.tex) - updated and include some CAL errors 
    (src/ConcreteArfDataServer.cc) - solved problem with polygons (SPR-2147)
    (src/CalCoreData.cc/h, src/CirclePsfModel.cc/h) - added support for
           annuli in the circular PSF model (SPR-2048)
    (src/ConcreteArfDataServer.cc,
         RmfEbins.cc...            ) - mods for compiling with optimisation
                                       on (SPR-2134)

Version 1.44.4 2001-05-18 (RDS)
------------------------------
    (doc/arfgen_description.tex) - updated for 5.1 changes (SPR-2033, 2040)
 
Version 1.44.3 2001-05-16 (RDS)
------------------------------
+   (src/AreaCalc.cc) - fix for separated areas causing backscale 
to fail (SPR-2041)
    (src/ConcreteArfDataServer.cc) - doesn't fail for bad Filter if a
    backscale run
    (doc/arfgen_description.tex) - updated for 5.1 changes
 

Version 1.44.2 2001-05-15 (RDS)
------------------------------
+   (src/DetmapFilter.cc) - problem with X/Y defined bad pixels (SPR-2036)

Version 1.44.1 2001-05-08 (RDS)
------------------------------
+   (src/ConcreteArfDataServer.cc,
         OffCCDPixelIterator.cc,
         AreaCalc.cc) - calculating backscale for multiple region (SPR-2020)

Version 1.44 2001-05-02 (RDS)
------------------------------
+ (config/arfgen.par,
   src/ConcreteArfDataServer.cc/h,
       PosWCS.cc/h,
       PositionUtils.cc): Allow calculation of attitude from the RA_PNT,
DEC_PNT, PA_PNT values and not using the attititude values in the OAF.
This is now an option controlled by the parameter useoafatt (SPR-2018)

Version 1.43.1 2001-04-27 (RDS)
------------------------------
+ (src/ConcreteArfDataServer.cc/h,
       OffCCFPsfPixelIterator.cc): Support for different shaped regions
plus multiple regions (SPR-2006)

Version 1.43 2001-04-15 (RDS)
------------------------------
------------------------------
+ (config/arfgen.par): New parameters, withbadpixcorr and badpixlocation, 
to control bad pixel and chip gap corrections (SCR-13)
 
+ (config/arfgen.par): New parameters, backscale and keeparfset, to allow
BACKSCAL setting with the backscale metatask (SCR-28).

+ (src/SetBackScale.cc/h, src/Arfgen.cc): BACKSCAL setting (SCR-28).

+ (src/AreaCalc.cc/h): Calculates mirror areas as fn of position (SPR-1952)
Only calculates Q.E. once to save time (SPR-1975)
 
+ (src/ConcreteArfDataServer.cc/h,
  src/CalCoreData.cc/h,
  src/BadPixPsfCorrector.cc/h,
  src/BadPixelCorrector.cc/h,
  src/BpCorrector.h,
  src/CalCoreData.cc/h,
  src/CompactTablePixelIterator.cc/h,
  src/DetmapFilter.cc/h,
  src/MissingPixCorrector.cc/h,
  src/NullBadPixelCorrector.cc/h,
  src/OffCCDPSFCorrector.cc/h,
  src/OffCCDPixelIterator.cc/h,
  src/PositionUtils.cc/h,
  src/PsfmodelPixelIterator.cc/h,
  src/RatioPsfModel.cc/h): Supports bad pixels and chip gaps (SCR-13, SCR-45)
 
Version 1.42.3 2001-03-15 (HS)
------------------------------

+ (src/ConcreteArfDataServer.cc):
        Calls to WCSConvertor object now uses new WCSConvertor interface, and XY->DETXY conversion improved. (SOC-SPR-1890)
	
+ (src/ConcreteArfDataserver.cc, 
   src/PositionUtils.[cc,h],
   src/CoreData.[cc,h],
   src/CalCoreData.[cc,h],
   src/CalMOSCoreData[.cc,h], 
   src/CalMOSCoreData[.cc,h]): 

	Modified withsourcepos=n code such that sourceposition
	object is created
	after CoreData object is constructed. (SOC-SPR-1956)

+ (src/RegionExtent.[cc,h]): 
	Made region extent computation for regions defined in XY coords more robust (SOC-SPR-1890).

+ (src/RmfEbins.[cc]): 
    Now supports RMF files with matrix table of name 'SPECRESP MATRIX' (SOC-SPR-1946).

+ (test dir): 
    Improved test harness to aid development. Now uses updated test data.

Version 1.42.2 2001-02-26 (RDS)
------------------------------

+ (src/CirclePsfModel.cc/.h): New routines to provide support for a new
PSF implementation in the CAL (SCR-36) 

+ (src/ConcreteArfDataServer.cc/h): Explicitly calls PSF creation routine
                              (SCR-36)

+ (src/CalCoreData.cc/h,CoreData.h): Creates a circular PSF if relevant (SCR-36)

+ (src/CalPsfModel.cc/h): Returns HIGH as its mode (SCR-36)

+ (src/PointEeCorrector.cc): Uses PSF iterator (SCR-36)

+ (src/PsfModel.h): Extra methods (SCR-36)

+ (src/Makefile): Includes new CirclePsfModel class (SCR-36)

Version 1.42.1 2001-02-05 (RDS)
------------------------------

+ (config/arfgen.par): Changed default maptype to 'flat' (SOC-SCR-32)

+ (src/ConcreteArfDataServer.Cc): Exit if no DSS found, if source
position not specified, assume it lies at centre of source box. (SOC-SCR-32)

+ (src/AreaCalc.cc): Output some helptext if detector map is zero (SOC-SCR-32)

+ (test/mosspectrum.ds): Fixed error in DSS coordinates in file

Version 1.42   2000-12-19 (HS)
------------------------------

+ (src/ConcreteArfDataServer.cc): Fixed seg fault when a 'flat' detector map is created. New test harness added to test this. (SOC-SPR-1888)

+ (src/PsfmodelPixelIterator): Fixed bug causing object to assume incorrect y-bounds (SOC-SPR-1889)

+ (src/PsfmodelPixelIterator): Bounds arguments in constructor changed from integer to double. 

	
Version 1.41.13   2000-12-04 (HS)
---------------------------------

+ (src/CalCoreData.cc): Removed temporary fix to the PHI angle introduced in 1.41.11, following identification of root of problem and subsequent changes to the cal package.
	
Version 1.41.12   2000-11-29 (HS/RDS)
---------------------------------

+ (src dir): Previous version contained other redundant changes - modified files such that the only change made is in CalCoreData.cc

Version 1.41.11   2000-11-27 (RDS)
---------------------------------

+ (src/CalCoreData.cc): Added PI to azimuthal angle (PHI) for effective
   area calculation (Hack - no SPR).

Version 1.41.10   2000-11-14 (HS)
---------------------------------

+ (DEPEND): Added emsaplib to list (SOC-SPR-1841)

+ (src/CalPsfModel.cc): Switched PSF model accuracy level
	to HIGH, which leads to a correctly normalised model (SOC-SPR-1840)


Version 1.41.9   2000-11-10 (HS)
------------------------------
+ Removed parameters --datalabel, --photondistset and --modelpileup from code (SOC-SPR-1779).
	
+ (src/ConcreteArfDataServer.cc): PSF/FLAT detector maps by default are automatically sized to the extent of the selected regions (SOC-SPR-1828).

  INTERFACE CHANGE: Added new parameter --withdetbounds. If false (default), then bounds for PSF/FLAT detmaps taken from DSS information.
	
Version 1.41.8   2000-11-02 (HS)
------------------------------
+ (src/CalPsfModel.cc): Fixed bug causing incorrect PSF models being generated for legitimate source positions (SOC-SPR-1818).
	
Version 1.41.7   2000-10-31 (HS)
------------------------------
+ (doc/arfgen_description.tex): Further documentation clean-up (SOC-SPR-1810)

Version 1.41.6   2000-10-30 (HS)
------------------------------
+ (src/ConcreteArfDataServer.cc): Fixed bug resulting in failure to compile under Linux and DEC/OSF (SOC-SPR-1795)
	
+ (src/ConcreteArfDataServer.cc): Fixed bug in referencing wrong parameter name (SOC-SPR-1798)
	
+ (doc/arfgen_description.tex): Added an description for the parameter psfenergy (SOC-SPR-1807)

Version 1.41.5   2000-10-20 (HS)
------------------------------
+ (src dir): Now take into consideration new global attributes
	propagated from attcalc (SOC-SPR-1793).
		
Version 1.41.4   2000-10-19 (HS)
------------------------------
+ (src dir): PSF model now taken from CAL (SOC-SPR-1790). 
	This required an
	INTERFACE CHANGE: new parameter psfenergy.
+ (doc/arfgen_description.tex): Moved Examples section to top of doc.
	Minor re-wording of some points. 
	Renumbered versions in changelog (SOC-SPR-1791).
	
Version 1.41.3   2000-10-15 (HS)
------------------------------
+ (src/IterEeCorrector.cc, test dir): 
	Fixed bug in EE interpolation causing 
	test harness failure on DEC/OSF machines 
	and made minor improvements to test harness (SOC-SPR-1784).
+ (config/arfgen.par): Changed lower limit for parameters 
	eegridfactor, patternmin and patternmax 
	to 1,0 and 0 respectively. (SOC-SPR-1777).
+ (src dir): Cleaned up code (SOC-SPR-1778).
+ (src dir): Cleaned up messages (SOC-SPR-1713).
	

Version 1.41.2   2000-10-14 (HS)
------------------------------
+ (src/CalMOSCoreData.cc): Fixed bug which had resulted in 
	MOS2 spectra being corrected using MOS1 calibration models 
	(SOC-SPR-1774)

+ (src/DetmapFilter.cc): Fixed bug that raised a CAL initialisation 
	warning during the internal attcalc call (SOC-SPR-1776).
	
+ (src dir): Filter transmission correction previously modelled 
	only on-axis sources. 
	This has been fixed to address all possible 
	source positions (SOC-SPR-1775).
	
Version 1.41.1   2000-10-12 (HS)
------------------------------
+ (src/PositionUtils.cc): Fixed bug in converting a source position 
	from DET coordinates to polar (theta, phi) coords. 
	This bug impacted on the offaxis effective area modelling (SOC-SPR-1766).
	
Version 1.41   2000-10-09 (HS)
------------------------------
+ (config doc dir): Increased default size of detmap from 400x400 to 800x800
	
Version 1.40   2000-10-09 (HS)
------------------------------

+ (src dir): Sums QE curves over all patterns defined in DSS
+ (src dir): Raises a warning if selected region extends outside
	bounds of detector map.
	
Version 1.39   2000-10-02 (HS)
------------------------------
+ (test/pnspectrum.ds): Changed filter name to 'THIN1' 
	for compatibility with cal-3.83
+ (config, src dir): INTERFACE CHANGE: added new parameter: filterdss
	
Version 1.37   2000-09-22 (HS)
------------------------------
+ Fixed test harness, which was pointing to wrong cif file.
	
Version 1.36   2000-08-31 (HS)
------------------------------
+ Now makes use of FILTER keyword in spectrum files (SOC-SPR-1733)

+ Now returns a zero arf is source is outside selected region (SOC-SPR-1720)

+ Fixed bug in PSF model description for PN (SOC-SPR-1719)

+ Fixed bug in energy grid in o/p ARF (SOC-SPR-1715)

+ INTERFACE CHANGE: parameters withfilteredset and filteredset added,
	allowing the filtered pixel list used during
	the ARF generation to be analysed later.

+ attcalc no longer called if none of the regions used
	to accumulate the spectrum correspond to X/Y space

+ Added further information about use of detector maps (SOC-SPR-1734)

Version 1.35   2000-08-07 (HS)
------------------------------
+ Now filter detector map based on DSS info stored in spectrum,
	instead of SLCTEXPR attribute.
+ Use filtered detector map in main ARF loop as well as for EE corrn.
+ Fixed bug in WCS mapping defined PsfmodelIterator such that a pixel index maps to the physical coordinates appropriate to the pixel centre as opposed to it's bottom-left corner.
	
Version 1.34   2000-08-03 (HS)
------------------------------
+ Previous upload failed - uploading new version
	
Version 1.33   2000-08-03 (HS)
------------------------------
+ (doc/arfgen_description.tex, src dir): INTERFACE CHANGE added new param 
	withsourcecoords: if set to false, the source position is taken
	from RA_OBJ/DEC_OBJ attributes of the input spectrum
+ (doc/arfgen_description.tex, src dir): INTERFACE CHANGE replaced parameters
	detxmin,detxmax.. with detxoffset, detyoffset. This should
	prevent dummy detmaps being generated which do not include
	the source position. Now raise an error if dataset-based
	detmaps do not include source (SOC-SPR-1599)
+ (doc/arfgen_description.tex, src dir): INTERFACE CHANGE renamed 
	'dummy' detector map option to 'flat'.

+ (src dir): fixed bug resulting in arfgen failing if a detmap
	pixel does not lie on a CCD (SOC-SPR-1687)
	
+ (src dir): fixed bug in type conversion when inputting negative source positions, 
	resulting in a normalisation of zero for psf-type detmaps (SOC-SPR-1699) 
	
	

	
Version 1.32   2000-07-28 (HS)
------------------------------
+ (doc/arfgen_description.tex) datautils-0.6 has removed requirement that detmaps be real-64; doc updated accordingly.

+ (src/ConcreteArfDataServer.cc, doc/arfgen_description.tex): Moved WCS axes check from WCSConvertor class to ConcreteArfDataServer, and renamed error label.
	
Version 1.31   2000-07-28 (HS)
------------------------------
+ (src dir): moved most of the generic pixel list manipulation classes to datautils.
		
Version 1.30   2000-07-18 (HS)
------------------------------
+ (test dir): Cleaned up.

Version 1.29   2000-07-17 (HS)
------------------------------
+ (test/testarfgen_pn): Now works without having to set SAS_ODF prior to test.
+ (src directory): Cleaned MOS/PN code - now share position conversion code in
	           PositionUtils.cc/.h
	
Version 1.28   2000-07-13 (HS)
------------------------------
+ (src directory): Added initial code for PN support.
	
Version 1.27.4 2000-06-30 (HS)
------------------------------
Following wrt SOC-SPR-1597:
+ (DEPEND): added package oal
+ (src/Makefile): added oal to USEDLIBS
+ (doc/arfgen_description.tex): Added discussion of oal usage
	
Version 1.27.3 2000-06-15 (HS)
------------------------------
+ (src/RmfEbins.cc): Now convert RMF energy grid (keV) to intrinsic CAL units of eV (SOC-SPR-1591 : energy grid not read in correctly from RMF (withrmfset=true))
	
Version 1.27.2 2000-06-15 (HS)
------------------------------
+ (doc/arfgen_description.tex): Replaced contructs \kn{A,B,C} with kn{A}, \kn{B}, etc, for all macro types. (SOC-SPR-1566: DOC::improper use of LaTeX macro)
+ (doc/arfgen_description.tex): Removed \task{} macro around another appearance of the task detmapgen (SOC-SPR-1536).

Version 1.27.1 2000-06-15 (HS)
------------------------------
+ (config/Makefile): Added arfgen.info to CONFIGFILES list (SOC-SPR-1505)
+ (config/arfgen.info): Changed GROUPS entry to 'mos spectral' (SOC-SPR-1538)
+ (doc/arfgen_description.tex): Removed \task{} macro around suggested task detmapgen (SOC-SPR-1536)
+ (doc/arfgen_description.tex): Removed \task{} marco around XSPEC (SOC-SPR-1537)

Version 1.27 2000-05-29 (HS)
------------
+ Fixed SPR-1358: arfgen should write ARF table with name 'SPECRESP'\
+ Changed detmap defaults to shorten default execution time by factor 16.
	
Version 1.26 2000-05-25 (HS)
------------
+ INTERFACE CHANGE : removed modelgrating parameter, as
	RGA obscuration wrt MOS spectra is already accounted
	for by CAL_getEffectiveArea
	
Version 1.25 2000-05-19 (HS)
------------
+ INTERFACE CHANGE not backwards compatible with previous release
+ Supports detector maps
+ Source position can be specified in terms of sky or detector coords
+ task description in sync with code.
	
Version 1.24 1999-12-16 (HS)
------------
- fixed depend file (no longer mentions patch extension to version no.)
	
Version 1.23 1999-10-29 (HS)
------------
- compatible with cal-1.31

Version 1.22 1999-09-23 (HS)
------------

- compatible with rmfgen-1.29
- added .lyt file, and extendedsource param in configuration file (not yet used in task)
	
Version 1.21 1999-09-15 (HS)
------------
- Closed SPR-111:Make arfgen documentation more 'user-friendly'
	
Version 1.20 1999-09-06 (HS)
------------
- local latex commands removed.

Version 1.19 1999-08-20 (HS/UL)
------------

- now compatible with cal-3.15.
	
- updated documentation. detectorlut task now included.

Version 1.18 1999-07-26 (HS)
------------
- CLOSED SPR-715: "Problems building (static link?)", by placing the arfgen library first in the USELIBS variable defn in test/Makefile

- renamed detectormap to detectorlut

- made a draft update to documentation

Version 1.17 1999-06-24 (HS)
------------
- renamed parameters according to SAS convention. 

- Added two extra parameters, withascregion and ascregionset, 
	to support ASC region files. This is required by BACKCORR.
	These parameters are currently ignored by code.
	
Version 1.16 1999-06-08 (HS)
------------
- CLOSED SPR-682: arfgen.cc: wrong C++ semantics results in multiple copies
	
Version 1.15 1999-06-08 (HS)
------------
- Fixed DEPEND file to reference responselib-0.9              

Version 1.14 1999-06-07 (HS)
------------
- Made compatible with cal-3.0              

Version 1.13 1999-05-27 (HS)
------------
- Fixed HUGE_VAL bug raised by Achim Bohnet

Version 1.12 1999-05-20 (HS)
------------
- Made compatible with error-1.18

Version 1.11 1999-04-27 (HS)
------------
- Made compatible with CAL-2.19

Version 1.10 1999-03-26 (MB)
------------
- added test files, removed commands that create them with deceit

Version 1.9 -   22-02-1999
-----------
- Code now compatible with cal-2.4 and dal-1.43

Version 1.8 -   09-02-1999
-----------
- Code now compatible with CAL-1.21
- Problems with DAL SubTableProcessor (DAL-1.41). No longer inherit
	from this class.

Version 1.7 -   04-02-1999
-----------
- Ported code to C++
- Added pile-up algorithm

Version 1.6  -  29-01-1999
-----------
- Fixed further bug in rectangularSpec.cc

Version 1.5  -  29-01-1999
-----------
- Fixed unsigned int/int clash in rectangularSpec.cc
	
Version 1.4  -  12-11-1998
-----------
- Added filledcolumnfns library to arfgen package. This library was originally
	part of rmfgen but was no longer required after rmfgen was ported 
	to C++.

Version 1.3   - 24-09-1998
-----------
- File names changed to type f in parameter file (MB).

Version 1.2  -  03-06-98
-----------
- Changed variables row and energy from int16 to standard integers. 
	This corrects the NAGACE compiler problem raised 
	by J Ballet (2 June 1998)

Version 1.1  -  20-05-98
-----------
- closed SOC-SPR-208 : use module variables to pass parameters from arfgen to get_arf
- closed SOC-SPR-209 : do not check SAS_DIR and/or source sas-setup.csh (test/testarfgen)
- The following SPRs have been closed as a consequence of changes made for the package sas-1.1: 

	SOC-SPR-207 : remove config/arfgen.prm

Version 1.0  -  04-05-98
-----------
- Initial version for SAS v1 integration
